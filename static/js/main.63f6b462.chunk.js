(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{163:function(e,t,a){e.exports=a(345)},177:function(e,t){},179:function(e,t){},190:function(e,t){},192:function(e,t){},219:function(e,t){},221:function(e,t){},222:function(e,t){},228:function(e,t){},230:function(e,t){},248:function(e,t){},251:function(e,t){},267:function(e,t){},270:function(e,t){},334:function(e,t){},344:function(e,t,a){},345:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(33),s=a.n(o),c=a(12),i=a(13),u=a(15),l=a(14),m=a(21),d=a(2),_=a.n(d),p=a(5),f=a(36),h=a.n(f),g=(a(70),a(24)),v=a.n(g),b=a(34),y=a(35),w=a(19),E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:1,user:null,rooms_details:{},current_room:"5f32a4fc7a25325b2c951a2d",sent_messages:[],generated_room:[],okay_to_create:!1,generate_room_raw:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case 0:return Object(w.a)(Object(w.a)({},e),{},{page:t.props.page});case 1:return Object(w.a)(Object(w.a)({},e),{},{user:t.props});case 2:return Object(w.a)(Object(w.a)({},e),{},{rooms_details:t.props});case 3:return Object(w.a)(Object(w.a)({},e),{},Object(y.a)({},t.props.key,t.props.value));case 4:var a=t.props;return e.rooms_details[a.room_id].chats.push(a),Object(w.a)(Object(w.a)({},e),{},{rooms_details:e.rooms_details});case 5:return e.sent_messages=t.props.sent_messages,Object(w.a)({},e);default:return e}},k=Object(b.b)({admin:E}),x=Object(b.c)(k),O=function(e){return{type:1,props:e}},j=function(e){return{type:2,props:e}},S=function(e){return{type:4,props:e}},N=function(e,t){return{type:3,props:{key:e,value:t}}},C=function(e){return{type:5,props:{sent_messages:e}}},T=function(e){x.dispatch(O(e))},A=function(e){x.dispatch(j(e))},U=function(e,t){x.dispatch(N(e,t))},D=function(e){x.dispatch(S(e))},P=function(e){x.dispatch(C(e))},M=a(16),B=a.n(M),H="https://CHAT33720.momodoubah1.repl.co/",L=function(){var e=Object(p.a)(_.a.mark((function e(t){var a,n,r,o,s,c,i=arguments;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.password,r=!(i.length>1&&void 0!==i[1])||i[1],o="".concat(H,"users/").concat(r?"login":"register"),s={user_name:a,password:n,email:null,full_name:null},e.next=6,B.a.post(o,s).then((function(e){return e.data})).catch((function(e){return console.log(e),{success:!1,message:"Unable to get details."}}));case 6:return c=e.sent,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={login:!0,loading:!1,form:{username:null,password:null,password_confirm:null},err:null},e.render_input_containers=function(){var t=e.state,a=t.form,n=t.login,o=t.loading;if(o)return r.a.createElement("div",{className:"login_loading_container"},r.a.createElement(v.a,{type:"Circles",color:"#000",height:25,width:25}),r.a.createElement("p",null,n?"Logging in":"Creating account for"," ",a.username));var s=[],c=function(t){s.push(r.a.createElement("input",{type:t.includes("password")?"password":"text",onChange:function(a){return e.change_input(a,t)},disabled:o,key:t,placeholder:"Enter "+t}))};for(var i in a)c(i);return n&&(s=s.slice(0,2)),r.a.createElement("div",{className:"login_box_inputs"},s.map((function(e,t){return e})))},e.is_proceed_disabled=function(){var t=e.state.form,a=0;for(var n in t)a=null==t[n]?a+1:a;return 0!=a},e.click_proceed=Object(p.a)(_.a.mark((function t(){var a,n,r,o,s,c;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,n=a.form,r=a.login,o=n.password,s=n.password_confirm,e.setState({loading:!0}),r&&(n.password_confirm=n.password),o!=s){t.next=13;break}return n.password=h.a.encrypt(n.password),e.setState({err:null}),t.next=9,L(n,r);case 9:(c=t.sent).success&&c.hasOwnProperty("data")&&null!=c.data&&void 0!=c.data?T(c.data):e.setState({err:c.message}),t.next=14;break;case 13:e.setState({err:"Ensure both passwords match"});case 14:e.setState({loading:!1});case 15:case"end":return t.stop()}}),t)}))),e.toggle=function(){var t=e.state.login;e.setState({login:!t}),t&&alert("Passwords are encrypted, but since the source code for this application is public, they can be decrypted easily. Thank you.")},e.change_input=function(t,a){var n=t.target,r=e.state,o=r.form,s=r.login,c=n.value,i=""==c?null:c;o[a]=i,s&&"password"==a&&(o.password_confirm=i),e.setState({form:o})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.state,t=e.login,a=e.loading,n=e.err,o=a||this.is_proceed_disabled();return r.a.createElement("div",{className:"login_container"},r.a.createElement("p",{className:"logo_main"},"CHAT337"),this.render_input_containers(),r.a.createElement("div",{className:"instead_button_container"},r.a.createElement("button",{className:a?"instead_button_dis":"instead_button",disabled:a,onClick:this.toggle},t?"Register":"Login"," instead"),r.a.createElement("button",{onClick:this.click_proceed,id:o?null:"proceed_button",disabled:o,className:o?"instead_button_dis":"instead_button"},t?"Login":"Register")),r.a.createElement("p",{className:"err_message"},n))}}]),a}(n.Component),q=a(162),R="https://CHAT33720.momodoubah1.repl.co/",I={get_room_details:function(){var e=Object(p.a)(_.a.mark((function e(t,a){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(R,"rooms/get_room_by_id/").concat(t,"/").concat(a),e.next=3,B.a.get(n).then((function(e){return e.data})).catch((function(){return{success:!1,message:"Unable to get details."}}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),delete_account:function(){var e=Object(p.a)(_.a.mark((function e(t,a){var n,r,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(R,"users/remove_account"),r={_id:t,password:a},e.next=4,B.a.post(n,r).then((function(e){return e.data})).catch((function(e){return console.log(e),{success:!1,message:"Unable to delete account, try again later."}}));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),update_key:function(){var e=Object(p.a)(_.a.mark((function e(t,a,n,r){var o,s,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(R,"users/edit_details"),s={key:t,value:a,password:n,_id:r},e.next=4,B.a.post(o,s).then((function(e){return e.data})).catch((function(e){return{success:!1,logout:!0,message:"Logging you out, either because you don't have an internet connection or becuase password entered was incorrect"}}));case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),get_people:function(){var e=Object(p.a)(_.a.mark((function e(t){var a,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(R,"users/find_by_username/").concat(t),e.next=3,B.a.get(a).then((function(e){return e.data})).catch((function(){return{success:!1,message:"Unable to get results at this time"}}));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create_room:function(){var e=Object(p.a)(_.a.mark((function e(t,a){var n,r,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(R,"rooms/create_room"),r={_id:t,members_add:a},e.next=4,B.a.post(n,r).then((function(e){return e.data})).catch((function(e){return{success:!1,message:"Unable to create room at this time, try again later."}}));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),leave_room:function(){var e=Object(p.a)(_.a.mark((function e(t,a){var n,r,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(R,"rooms/leave_room"),r={_id:t,room_id:a},e.next=4,B.a.post(n,r).then((function(e){return e.data})).catch((function(e){return{success:!1,message:"Unable to create room at this time, try again later."}}));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),seen_message:function(){var e=Object(p.a)(_.a.mark((function e(t,a,n){var r,o,s;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(R,"rooms/seen_message"),o={_id:t,timestamp:a,person_id:n},e.next=4,B.a.post(r,o).then((function(e){return e.data})).catch((function(e){return console.log(e),{success:!1,message:"Unable to create room at this time, try again later."}}));case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),accept_room_request:function(){var e=Object(p.a)(_.a.mark((function e(t,a){var n,r,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(R,"rooms/accept_room_request"),r={_id:t,room_id:a},e.next=4,B.a.post(n,r).then((function(e){return e.data})).catch((function(e){return{success:!1,message:"Unable to create room at this time, try again later."}}));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},J=function(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!0;delete e["5f32aa2af1f8167792e527f1"];for(var o=Object.keys(e),s=function(s){var c=JSON.parse(JSON.stringify(t));if(!r)return"break";n?c.push(a):c=c.filter((function(e){return e._id!=a._id}));var i=e[o[s]].key,u=Object.keys(i);if(c.length>u.length)r=!0;else{var l=0;c.forEach((function(e){-1!=u.indexOf(e._id)&&l++})),r=l!=u.length}},c=0;c<o.length;c++){var i=s(c);if("break"===i)break}n?t.push(a):t=t.filter((function(e){return e._id!=a._id}));var u=[];return t.forEach((function(e){u.push(e._id)})),{generated_room:t,generated_room_raw:u,okay_to_create:r}},z=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={value:"",loading:!1,results:[],generated_room:[],okay_to_create:!1},e.search_users=Object(p.a)(_.a.mark((function t(){var a,n;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.value,e.setState({loading:!0}),t.next=4,I.get_people(a);case 4:(n=t.sent).success&&n.hasOwnProperty("results")&&e.setState({results:n.results}),e.setState({loading:!1});case 7:case"end":return t.stop()}}),t)}))),e.change_value=function(t){var a=t.target;e.setState({value:a.value})},e.add_to_room=function(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.props.admin,r=n.rooms_details,o=n.generated_room,s=J(r,o,t,a);U("generated_room",s.generated_room),U("generated_room_raw",s.generated_room_raw),U("okay_to_create",s.okay_to_create)},e.componentDidMount=function(){var t=e.props.admin.user._id;U("generated_room",[{_id:t}]),U("generated_room_raw",[t])},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props.admin.generated_room_raw,a=this.state,n=a.value,o=a.loading,s=a.results;return r.a.createElement("div",null,r.a.createElement("div",{className:"flex_type"},r.a.createElement("input",{value:n,onChange:this.change_value,className:"password_one",placeholder:"Search for users"}),r.a.createElement("button",{onClick:this.search_users},"Search")),o?r.a.createElement("div",{className:"login_loading_container_3"},r.a.createElement(v.a,{type:"Circles",color:"#000",height:25,width:25}),r.a.createElement("p",null,"Searching...")):null,0==s.length&&""!=n?r.a.createElement("p",null,"No results yet"):s.length>0?r.a.createElement("div",null,s.map((function(a){return r.a.createElement("div",{onClick:function(){return null},className:"room_button"},r.a.createElement("p",null,a.user_name),r.a.createElement("span",{className:"timestamp"},a.full_name),-1==t.indexOf(a._id)?r.a.createElement("button",{onClick:function(){return e.add_to_room(a)}},"Add to room"):null)}))):null)}}]),a}(n.Component),F=Object(m.b)((function(e){return{admin:e.admin}}))(z),G=a(158),W=a.n(G).a.connect("https://CHAT33720.momodoubah1.repl.co/"),$=a(159),K=a.n($),Q=a(160),V=function(){var e=Object(p.a)(_.a.mark((function e(t,a){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://CHAT33720.momodoubah1.repl.co/rooms/push_message",n={_id:t,message:a},e.next=4,B.a.post("https://CHAT33720.momodoubah1.repl.co/rooms/push_message",n).then((function(e){return e.data})).catch((function(e){return console.log(e),{success:!1,message:"Unable to get details."}}));case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),X=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1},e.recieve_message=W.off("user_typing").on("user_typing",(function(t){var a=e.props.admin,n=a.current_room,r=a.rooms_details[n];if(n==t.room_id&&void 0!=r){var o=r.key[t._id].user_name+" is typing...";e.setState({temp_message:o}),setTimeout((function(){e.setState({temp_message:null})}),2e3)}})),e.socket_confirm_join=W.off("confirm_enter_or_leave").on("confirm_enter_or_leave",(function(t){var a=e.props.admin,n=a.current_room,r=a.rooms_details[n];if(n==t.room_id&&void 0!=r){var o=r.key[t._id]+" has "+(t.join?"joined ":"left")+" the room.";e.setState({temp_message:o}),setTimeout((function(){e.setState({temp_message:null})}),2e3)}})),e.state={active:!1,hover:0,value:null,latest_time_stamp:null,temp_message:null},e.send_message=Object(p.a)(_.a.mark((function t(){var a,n,r,o,s,c,i,u,l,m;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props.user._id,null==(n=e.state.value)){t.next=18;break}return r=e.props.admin,o=r.current_room,s=r.sent_messages,c=(new Date).getTime(),s.push(c),P(s),e.setState({latest_time_stamp:c}),i={message:n,from:a,timestamp:c,room_id:o},W.emit("send_message",i),e.setState({value:""}),(u=document.getElementsByClassName("chat_box")).scrollTop=u.scrollHeight,delete i.room_id,t.next=16,V(o,i);case 16:(l=t.sent).success&&l.hasOwnProperty("confirmed")&&(m=e.filter_out(s,l.confirmed),P(m));case 18:case"end":return t.stop()}}),t)}))),e.filter_out=function(e,t){return e.filter((function(e){return e!=t}))},e.componentDidMount=function(){e.scrollToBottom()},e.change=function(t){var a=e.props.user._id,n=e.props.admin.current_room,r=t.target.value;/\s/.test(r)&&W.emit("typing",{_id:a,room_id:n});""!=r.replace(/^\s*\s*$/,"")?e.setState({value:r}):e.setState({value:null})},e.when=function(e){var t=new Date(e);t.toLocaleDateString(),t.toLocaleTimeString();return K()(t,"DD/MM/YYYY::HH:mm:SS").fromNow()},e.map_message_status=function(e){return{opacity:e<1?"0.6":"1",width:"100%",marginBottom:"1em"}},e.interpret_status=function(t,a){var n=e.props.admin,r=n.sent_messages,o=n.user;return-1==r.indexOf(t)?{message:o._id!=a?"":"Sent",style:{opacity:"1",width:"100%",marginBottom:"1em"}}:{message:"Sending...",style:{opacity:"0.6",width:"100%",marginBottom:"1em"}}},e.accept=Object(p.a)(_.a.mark((function t(){var a,n,r,o;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),a=e.props.admin,n=a.current_room,r=a.rooms_details,o=a.user,t.next=4,I.accept_room_request(o._id,n);case 4:t.sent.success?(r[n].send_accept_request=!1,U("rooms_details",r)):alert("Unable to accept at this time, try again later."),e.setState({loading:!1});case 7:case"end":return t.stop()}}),t)}))),e.reject=Object(p.a)(_.a.mark((function t(){var a,n,r;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),a=e.props.admin,n=a.current_room,a.rooms_details,r=a.user,t.next=4,I.leave_room(r._id,n);case 4:if(!t.sent.success){t.next=11;break}return t.next=8,e.props.set_up_rooms(!1,n);case 8:W.emit("refresh_your_rooms",{room_id:n,_id:r._id,add:!1}),t.next=12;break;case 11:alert("Unable to reject at this time, try again later.");case 12:e.setState({loading:!1});case 13:case"end":return t.stop()}}),t)}))),e}return Object(i.a)(a,[{key:"scrollToBottom",value:function(){Q.animateScroll.scrollToBottom({containerId:"chat_box"})}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props,a=t.rooms_details,n=t.admin,o=n.current_room,s=(n.sent_messages,this.state),c=s.value,i=s.temp_message,u=s.loading,l=a[o];return r.a.createElement("div",{className:"chat_container"},void 0!=l?r.a.createElement("div",null,l.send_accept_request?r.a.createElement("div",{className:"login_loading_container_2"},"Accept room request?",r.a.createElement("button",{disabled:u,onClick:this.accept},"Accept"),r.a.createElement("button",{disabled:u,onClick:this.reject},"Reject")):r.a.createElement("div",null,r.a.createElement("div",{id:"title_chat_container"},r.a.createElement("p",{id:"chat_username_title"},l.name),r.a.createElement("p",{className:"timestamp"},i||l.members.length+" people in chat room"),l.is_public?null:r.a.createElement("button",{disabled:u,onClick:this.reject},"Leave room")),r.a.createElement("div",{id:"chat_box",ref:function(t){return e.chat_box=t},className:"chat_box"},l.chats.map((function(t){var a=e.interpret_status(t.timestamp||0,t.from);return r.a.createElement("div",{style:a.style},r.a.createElement("h3",null,l.key[t.from].user_name||"Unkown"),r.a.createElement("p",null,t.message),r.a.createElement("div",{className:"chat_baseline"},r.a.createElement("p",{className:"timestamp"},e.when(t.timestamp)),r.a.createElement("p",{className:"timestamp"},a.message)))}))),r.a.createElement("div",null,r.a.createElement("textarea",{className:"chat_text_input",placeholder:"Enter message here",value:c,onChange:this.change}),r.a.createElement("div",{className:"send_button_container"},r.a.createElement("button",{disabled:null==c||""==c,className:"send_button",onClick:this.send_message},"Send"))))):r.a.createElement("div",null,r.a.createElement("div",{className:"login_loading_container_2"},r.a.createElement(v.a,{type:"Circles",color:"#000",height:25,width:25}),r.a.createElement("p",null,"Select a room on the right panel to get started..."))))}}]),a}(r.a.Component),Z=Object(m.b)((function(e){return{user:e.admin.user,rooms_details:e.admin.rooms_details,admin:e.admin,state:e}}))(X),ee=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).refresh=W.off("personal_refresh").on("personal_refresh",function(){var t=Object(p.a)(_.a.mark((function t(a){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.set_up_rooms(!!a.add&&a.room_id,!a.add&&a.room_id);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.refresh=W.off("told_to_refresh").on("told_to_refresh",function(){var t=Object(p.a)(_.a.mark((function t(a){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.set_up_rooms(!!a.add&&a.room_id,!a.add&&a.room_id);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.mapper=W.off("inform_who_is_online").on("inform_who_is_online",(function(t){var a=e.props.admin.user;W.emit("i_am_online",{room_id:t.room_id,_id:a._id,i_am_online:t.i_am_online})})),e.socket_confirm_join=W.off("confirm_that_i_am_online").on("confirm_that_i_am_online",(function(t){var a=e.props.admin,n=a.rooms_details,r=a.user;if(t._id!=r._id&&n.hasOwnProperty(t.room_id)){var o=!1,s=n[t.room_id],c=s.key;c.hasOwnProperty(t._id)&&(c[t._id].online=t.i_am_online,o=!0),o&&(s.key=c,n[t.room_id]=s,U("rooms_details",n))}})),e.mapper=W.off("inform_who_is_online").on("inform_who_is_online",(function(t){var a=e.props.admin.user;W.emit("i_am_online",{room_id:t.room_id,_id:a._id,i_am_online:t.i_am_online})})),e.recieve_message=W.off("recieve_message").on("recieve_message",function(){var t=Object(p.a)(_.a.mark((function t(a){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.admin.user,D(a);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.state={loading:!0,search_mode:!1},e.identify_room_name=function(e,t,a){if(a)return"Public chat room";var n="";return(t=t.filter((function(t){return t._id!=e}))).forEach((function(e){n+="".concat(e.full_name||e.user_name,"+")})),n+="You"},e.set_up_rooms=Object(p.a)(_.a.mark((function t(){var a,n,r,o,s,c,i,u,l,m=arguments;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=m.length>0&&void 0!==m[0]&&m[0],n=m.length>1&&void 0!==m[1]&&m[1],W.emit("connection"),r=e.props.admin.user,(o=r.rooms).push("5f3c08f3b5ee64012faba081"),0!=a&&o.push(a),n&&(o=o.filter((function(e){return e!=n}))),W.emit("join_room",{room_id:r._id,_id:r._id}),s={},c=0;case 11:if(!(c<o.length)){t.next=20;break}return i=o[c],t.next=15,I.get_room_details(i,r._id);case 15:(u=t.sent).success&&u.hasOwnProperty("room")&&(l=e.identify_room_name(r._id,u.room.members,u.room.is_public),u.room.name=l,s=Object.assign(s,Object(y.a)({},i,u.room)),W.emit("join_room",{room_id:i,_id:r._id}),W.emit("tell_me_who_is_online",{room_id:i,_id:r._id,i_am_online:!0}));case 17:c++,t.next=11;break;case 20:A(s),e.setState({loading:!1});case 22:case"end":return t.stop()}}),t)}))),e.componentDidMount=Object(p.a)(_.a.mark((function t(){var a,n;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.set_up_rooms();case 2:a=e.props.admin.user,(n=a.rooms).push("5f3c08f3b5ee64012faba081"),setInterval((function(){n.forEach((function(e){W.emit("tell_me_who_is_online",{room_id:e,_id:a._id,i_am_online:!0})}))}),6e4);case 6:case"end":return t.stop()}}),t)}))),e.componentWillUnmount=function(){var t=e.props.admin.user,a=t.rooms;a.forEach((function(e){W.emit("tell_me_who_is_online",{room_id:e,_id:t._id,i_am_online:!1})})),e.setState({loading:!0});for(var n=0;n<a.length;n++){var r=a[n];W.emit("leave_room",{room_id:r,_id:t._id})}},e.change_search_mode=function(t){e.setState({search_mode:t})},e}return Object(i.a)(a,[{key:"isMobileDevice",value:function(){return"undefined"!==typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")}},{key:"render",value:function(){var e=this.props.admin,t=(e.page,e.user),a=e.rooms_details,n=e.generated_room,o=e.okay_to_create,s=e.generated_room_raw,c=t.rooms,i=this.state,u=i.loading,l=i.search_mode;return r.a.createElement("div",{className:this.isMobileDevice()?"home_mob":"home"},l?r.a.createElement(te,{search_mode:l,change_search_mode:this.change_search_mode,set_up:this.set_up_rooms,generated_room_raw:s,rooms_details:a,generated_room:n,okay_to_create:o}):null,r.a.createElement(Z,{set_up_rooms:this.set_up_rooms,room_id:c[0]}),r.a.createElement(ae,{search_mode:l,change_search_mode:this.change_search_mode,_id:t._id,user:t,loading:u,rooms:a}))}}]),a}(n.Component),te=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1},e.remove_from_room=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.props,r=n.rooms_details,o=n.generated_room,s=J(r,o,t,a);U("generated_room",s.generated_room),U("generated_room_raw",s.generated_room_raw),U("okay_to_create",s.okay_to_create)},e.create_room=Object(p.a)(_.a.mark((function t(){var a,n,r,o,s,c;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),a=e.props,n=a.generated_room,r=a.generated_room_raw,o=n[0]._id,s=r.filter((function(e){return e!=o})),t.next=6,I.create_room(o,s);case 6:if(!(c=t.sent).success){t.next=14;break}return e.props.change_search_mode(!1),t.next=11,e.props.set_up(c.room_id);case 11:s.forEach((function(e){console.log(e),W.emit("refresh_your_rooms_indiv",{room_id:c.room_id,_id:e,add:!0})})),t.next=15;break;case 14:U("okay_to_create",-1);case 15:e.setState({loading:!1});case 16:case"end":return t.stop()}}),t)}))),e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.generated_room,n=t.okay_to_create,o=this.state.loading;return r.a.createElement("div",{className:"chat_container_less"},o?r.a.createElement("div",{className:"login_loading_container"},r.a.createElement(v.a,{type:"Circles",color:"#000",height:25,width:25}),r.a.createElement("p",null,"Creating room")):r.a.createElement("div",null,r.a.createElement("div",{className:"flex_3"},r.a.createElement("h3",null,"Generate new room"),r.a.createElement("button",{onClick:function(){return e.props.change_search_mode(!1)}},"Cancel")),r.a.createElement("p",null,"Search and add on the right panel. Final changes here."),a.map((function(t){return t.hasOwnProperty("user_name")?r.a.createElement("div",{className:"flex_3"},r.a.createElement("h2",null,t.user_name),r.a.createElement("button",{onClick:function(){return e.remove_from_room(t)}},"Remove account")):null})),r.a.createElement("button",{onClick:this.create_room,disabled:!n||!(a.length>1)}," Create chat room "),a.length>1?r.a.createElement("p",{className:"err_message"}," ",n?null:"Either add or remove users to generate room. This error message indicates their is a duplicate room"," "):null,r.a.createElement("p",{className:"err_message"}," ",-1==n?"Unable to create room at the moment":null," ")))}}]),a}(n.Component),ae=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={delete_room:!1,err:null,password:"",loading_2:!1,show_pref:!0},e.change_attribute=function(e){U("current_room",e)},e.summarize_key=function(e,t){var a="",n=0;for(var r in e)r!=t&&n<3&&(a+=e[r].user_name+" is "+(e[r].online?"online ":"offline ")),n++;return a},e.render_room_content=function(){var t=e.props,a=t.rooms,n=t._id;return r.a.createElement("div",null,Object.entries(a).map((function(t){var a=Object(q.a)(t,2),o=a[0],s=a[1];return r.a.createElement("div",{onClick:function(){return e.change_attribute(o)},className:"room_button"},r.a.createElement("p",null,s.name),r.a.createElement("span",{className:"timestamp"},e.summarize_key(s.key,n)))})))},e.delete_acc=Object(p.a)(_.a.mark((function t(){var a,n,r,o,s,c;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({loading_2:!0}),a=e.props,n=a._id,r=a.user,""==(o=e.state.password)){t.next=18;break}s=0;case 5:if(!(s<r.rooms.length)){t.next=13;break}return t.next=8,I.leave_room(n,r.rooms[s]);case 8:t.sent.success&&W.emit("refresh_your_rooms",{room_id:r.rooms[s],_id:n,add:!1});case 10:s++,t.next=5;break;case 13:return o=h.a.encrypt(o),t.next=16,I.delete_account(n,o);case 16:(c=t.sent).success?(alert("Your account has been removed, have a good day!"),T(null)):e.setState({err:c.message});case 18:e.setState({loading_2:!1});case 19:case"end":return t.stop()}}),t)}))),e.preferences_section=function(){var t=e.props.user,a=e.state.delete_room;return r.a.createElement("div",{className:"reg_spacing"},["user_name"].map((function(e){return r.a.createElement("p",null,e,": ",t[e])})),["password"].map((function(e){return r.a.createElement("div",null,r.a.createElement(ne,{_id:t._id,text:e+": *******",type:"password",key_name:e}))})),["email","full_name"].map((function(e){return r.a.createElement("div",null,r.a.createElement(ne,{_id:t._id,text:e+": ".concat(t[e]||"Not set"),type:"text",key_name:e}))})),r.a.createElement("div",{className:"flex_type"},r.a.createElement("button",{onClick:function(){return T(null)},className:"send_button"},"Logout"),r.a.createElement("button",{className:"send_button",onClick:e.toggle_del},a?"Cancel":"Delete account")))},e.change_pass_val=function(t){var a=t.target;e.setState({password:a.value,err:null})},e.toggle_del=function(){e.setState({delete_room:!e.state.delete_room})},e.toggle_mode=function(){e.props.change_search_mode(!e.props.search_mode)},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.search_mode,o=this.state,s=o.delete_room,c=o.err,i=o.password,u=o.loading_2,l=o.success,m=o.show_pref;return r.a.createElement("div",{className:"chat_container_less"},r.a.createElement("div",{className:"flex_3"},r.a.createElement("h3",null,"Preferences"),r.a.createElement("button",{onClick:function(){return e.setState({show_pref:!m})}},"Toggle preferences")),m?r.a.createElement("div",null,this.preferences_section()):null,s?r.a.createElement("div",null,r.a.createElement("div",{className:"flex_type"},r.a.createElement("input",{value:i,onChange:this.change_pass_val,className:"password_one",type:"password",placeholder:"Enter password to confirm"}),r.a.createElement("button",{disabled:u,onClick:this.delete_acc},u?"Deleting...":"Delete!")),r.a.createElement("p",null,"You will be removed from all rooms including the chats on the public one as well. Thank you!")):null,r.a.createElement("p",{className:"err_message"},c),r.a.createElement("p",{className:"success_message"},l),r.a.createElement("div",{className:"flex_3"},r.a.createElement("h3",null,"Rooms"),r.a.createElement("button",{onClick:this.toggle_mode},n?"Existing rooms":"Add rooms")),n?r.a.createElement(F,null):r.a.createElement("div",null,this.render_room_content(),a?r.a.createElement("div",{className:"login_loading_container"},r.a.createElement(v.a,{type:"Circles",color:"#000",height:25,width:25}),r.a.createElement("p",null,"Loading rooms")):null))}}]),a}(n.Component),ne=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={change:!1,value:"",password:"",loading:!1,success:"",err:null},e.toggle=function(){e.setState({change:!e.state.change})},e.update=Object(p.a)(_.a.mark((function t(){var a,n,r,o,s,c,i;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({loading:!0}),a=e.props,n=a._id,r=a.key_name,o=e.state,s=o.value,""==(c=o.password)||""==s){t.next=11;break}return"password"==r&&(s=h.a.encrypt(s)),t.next=7,I.update_key(r,s,h.a.encrypt(c),n);case 7:(i=t.sent).success?(e.setState({password:"",value:"",success:i.message,change:!1}),setTimeout((function(){e.setState({success:""})}),3e3)):(e.setState({err:i.message}),i.logout&&setTimeout((function(){T(null)}),3e3)),t.next=12;break;case 11:e.setState({err:"Please give an input for both fields above"});case 12:e.setState({loading:!1});case 13:case"end":return t.stop()}}),t)}))),e.change_input=function(t){var a=t.target;e.setState({value:a.value,err:null})},e.change_input_ps=function(t){var a=t.target;e.setState({password:a.value,err:null})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.state,t=e.change,a=e.loading,n=e.err,o=e.value,s=e.password,c=e.success,i=this.props,u=i.key_name,l=i.type,m=i.text;return r.a.createElement("div",null,r.a.createElement("div",{className:"flex_3"},r.a.createElement("p",null,m),r.a.createElement("button",{onClick:this.toggle}," ",t?"Cancel key change":"Change "+u," ")),t?r.a.createElement("div",null,r.a.createElement("input",{className:"password_one",placeholder:"Set new "+u,value:o,type:l,onChange:this.change_input}),r.a.createElement("div",{className:"flex_type"},r.a.createElement("input",{className:"password_one",placeholder:"Enter password to confirm",value:s,type:"password",onChange:this.change_input_ps}),r.a.createElement("button",{onClick:this.update,disabled:a||""==o||""==s},a?"Making changes...":"Proceed"))):null,r.a.createElement("p",{className:"err_message"},n),r.a.createElement("p",{className:"success_message"},c))}}]),a}(n.Component),re=Object(m.b)((function(e){return{admin:e.admin}}))(ee),oe=a(161),se=(a(344),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).componentDidMount=function(){},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.admin,t=(e.page,e.user),a={num:[4,7],rps:.1,radius:[5,40],life:[1.5,3],v:[2,3],tha:[-40,40],alpha:[.6,0],scale:[.1,.4],position:"all",color:["random","#ff0000"],cross:"dead",random:15};return Math.random()>.85&&(a=Object.assign(a,{onParticleUpdate:function(e,t){e.beginPath(),e.rect(t.p.x,t.p.y,2*t.radius,2*t.radius),e.fillStyle=t.color,e.fill(),e.closePath()}})),r.a.createElement("div",null,null==t?r.a.createElement(Y,null):r.a.createElement(re,null),r.a.createElement(oe.a,{type:"custom",config:a,bg:!0}))}}]),a}(n.Component)),ce=Object(m.b)((function(e){return{admin:e.admin}}))(se);s.a.render(r.a.createElement(m.a,{store:x},r.a.createElement(r.a.StrictMode,null,r.a.createElement(ce,null))),document.getElementById("root"))},36:function(e,t,a){var n=a(173);n.randomBytes(32),n.randomBytes(16);e.exports={encrypt:function(e){var t=n.createCipher("aes-128-cbc","chat3372.0_password"),a=t.update(e,"utf8","hex");return a+=t.final("hex")}}}},[[163,1,2]]]);
//# sourceMappingURL=main.63f6b462.chunk.js.map